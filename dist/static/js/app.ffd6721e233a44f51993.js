webpackJsonp([2,0],[function(t,e,n){(function(t){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}var o=n(56),r=(e(o),n(65)),a=e(r),s=n(1),i=e(s),c=n(88),l=e(c),u=n(75),d=e(u),f=n(74),h=e(f),p=n(25),m=e(p);i.default.use(h.default),i.default.use(l.default),i.default.use(a.default);var v=new l.default({mode:"hash",base:t,routes:[{path:"/"},{path:"/songs/:word",component:n(80)},{path:"/song/:id",component:n(79)},{path:"*",redirect:"/"}]});new i.default({el:"#app",template:"<App/>",components:{App:d.default},router:v,store:m.default})}).call(e,"/")},,,,,,,,,,,,,,,function(t,e){},,,function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(57),a=(o(r),n(67)),s=o(a),i=n(78),c=o(i);e.default={name:"app",data:function(){return{value:"",searchWordArr:this.$store.state.searchWordArr}},components:{Welcome:c.default},methods:{handleSearch:function(){return console.log("click:"+this.value),""==this.value?void(0,s.default)("搜索关键字不可为空"):void(this.$store.state.showWelcome?this.$store.commit("hideWelcome"):this.toSongs())},handleWord:function(t){this.value=t,this.handleSearch()},toSongs:function(){""!=this.value&&(console.log("run toSongs"),this.$router.push({path:"/songs/"+this.value}),this.$store.commit("addSearchWord",{value:this.value}))}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),a=o(r);n(64);var s,i=n(2),c=n(16),l=o(c);e.default={name:"controls",data:function(){return{show:!1,lrcCurIndex:0,lrcLastIndex:0,currentTime:0,duration:1,loadedPercent:0,volume:100}},computed:(0,a.default)({},(0,i.mapState)({song:function(t){return t.song||{mp3Url:""}},lyricArr:function(t){return t.lyricArr},lrcTimeArr:function(t){return t.lrcTimeArr}}),{currentTimeStr:function(){return this.convertToTime(this.currentTime)},durationStr:function(){return this.convertToTime(this.duration)},playedPercent:function(){return this.currentTime/this.duration*100}}),created:function(){},mounted:function(){var t=this;console.log("song",this.song),s=document.getElementById("media"),s.addEventListener("loadeddata",function(e){var n=setInterval(function(){return s.buffered.length<1||(t.loadedPercent=s.buffered.end(0)/s.duration*100,void(Math.floor(s.buffered.end(0))>=Math.floor(s.duration)&&clearInterval(n)))},100)}),s.addEventListener("ended",function(){s.currentTime=0,t.$store.commit("changePlaying",!1)}),this.$root.$on("play",function(){t.show=!0,t.$store.commit("changePlaying",!0)}),this.$root.$on("pause",function(){s.pause(),t.$store.commit("changePlaying",!1)})},methods:{handleTimeUpdate:function(){0!=this.duration&&(this.duration=s.duration),this.currentTime=s.currentTime;var t=l.default.sortedIndex(this.lrcTimeArr,s.currentTime);this.lrcLastIndex!=t&&(this.lrcCurIndex=t,this.color(),this.disappear(),this.lrcLastIndex=t)},color:function(){for(var t=0;t<this.lyricArr.length;t++)this.lyricArr[t].selected=!1;this.lrcCurIndex>0&&(this.lyricArr[this.lrcCurIndex-1].selected=!0)},disappear:function(){this.lrcCurIndex>=2&&this.$store.commit("changeLrcMarginTop",this.lrcCurIndex*-2+4.25)},changePos:function(t){console.log(t);var e=t.offsetX;console.log("x",e),console.log("totalWidth",document.getElementById("bar").offsetWidth);var n=e/document.getElementById("bar").offsetWidth;console.log(n),s.currentTime=this.duration*n},changeVolume:function(t,e){var n=t.pageY,o=document.getElementById("volumeOuterBar").offsetHeight,r=this.getOffset(document.getElementById("volumeOuterBar"));this.volume=Math.abs(n-(r.top+o)),s.volume=this.volume/100},convertToTime:function(t){var e,n=Math.floor(t/60%60),o=Math.floor(t%60);return o<10&&(o="0"+o),n<10&&(n="0"+n),e=n+":"+o},getOffset:function(t,e){return e||(e={},e.top=0,e.left=0),t==document.body?e:(e.top+=t.offsetTop,e.left+=t.offsetLeft,this.getOffset(t.parentNode,e))}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2);e.default={name:"lyric",props:["id"],data:function(){return{show:!1,curIndex:0,defaultColor:"t-gra",selectedColor:"t-blu"}},computed:(0,o.mapState)({lrcArr:function(t){return t.lyricArr},lrcMarginTop:function(t){return t.lrcMarginTop}}),mounted:function(){var t=this;this.$store.dispatch("FETCH_LYRIC",this.id).then(function(){t.show=!0})},methods:{}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"welcome",computed:{show:function(){return this.$store.state.showWelcome}},data:function(){return{msg:"音乐之家"}},methods:{afterLeave:function(){this.$emit("afterLeave")}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),a=(o(r),n(17)),s=o(a),i=n(9),c=o(i),l=n(77),u=o(l),d=n(76),f=o(d),h=n(2);e.default={name:"song",data:function(){return{id:this.$route.params.id||"307525",show:!1}},computed:(0,c.default)({},(0,h.mapState)(["song","playing"]),{played:function(){return{"fa-play":!this.playing,"fa-stop":this.playing}}}),created:function(){var t=this;s.default.open("加载中..."),this.$store.commit("hideWelcome"),this.$store.dispatch("FETCH_SONG",this.id).then(function(){s.default.close(),t.show=!0})},methods:{handlePlay:function(){this.playing?this.$root.$emit("pause"):this.$root.$emit("play")}},components:{Lyric:u.default,Controls:f.default}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),a=(o(r),n(17)),s=o(a),i=n(2);e.default={name:"songs",data:function(){return{show:!1}},computed:(0,i.mapState)(["songs"]),created:function(){this.$store.commit("hideWelcome"),this.$store.commit("changePlaying",!1),this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;console.log("fetchData"),s.default.open("加载中...");var e=this.$route.params.word||"汪峰";console.log(e),this.$store.dispatch("FETCH_SONG_LIST",{s:e}).then(function(){s.default.close(),t.show=!0})}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t){var e={csrf_token:"",type:1,offset:0,limit:10,total:!0},n=(0,c.default)(t,e);console.log(n);var o=u.default.http.post("/api163/search/get/web",n);return o.then(function(t){console.log(t.data)},function(t){console.log("request error")}),o}function a(t){var e=u.default.http.get("/api163/song/detail?id="+t+"&ids=%5B"+t+"%5D");return console.log("url","http://music.163.com/api/song/detail?id="+t+"&ids=%5B"+t+"%5D"),e.then(function(t){console.log(t.data)},function(t){console.log("request error")}),e}function s(t){var e=u.default.http.get("/api163/song/lyric?os=pc&id="+t+"&lv=-1&kv=-1&tv=-1");return e.then(function(t){console.log(t.data)},function(t){console.log("request error")}),e}Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),c=o(i);e.fetchSongList=r,e.fetchSong=a,e.fetchLyric=s;var l=n(1),u=o(l),d=n(87),f=o(d);n(71);u.default.use(f.default),u.default.http.options.emulateJSON=!0},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t){var e=[];console.log(t.length);for(var n=0;n<t.length-1;n++){var o=t[n],r={},a=o.match("\\[(.+?)\\]")[1];if(!/[^0-9\.\:]/.test(a)){var s=a.split(":"),i=60*parseInt(s[0])+parseFloat(s[1]);r.selected=!1,r.show=!0,r.time=i,r.lrc=o.replace(new RegExp(/(\.\d{2,3})/g),""),e.push(r)}}return e}Object.defineProperty(e,"__esModule",{value:!0});var a=n(26),s=o(a),i=n(1),c=o(i),l=n(2),u=o(l),d=n(24),f=n(16),h=o(f);c.default.use(u.default);var p=new u.default.Store({state:{showWelcome:!0,searchWordArr:localStorage.searchWords?JSON.parse(localStorage.searchWords):[],songs:[],song:null,lyricArr:[],lrcTimeArr:[],lrcMarginTop:0,playing:!1},getters:{},actions:{FETCH_SONG_LIST:function(t,e){var n=(0,d.fetchSongList)(e);return n.then(function(e){t.commit("loadSongList",{songs:e.data.result.songs})}),n},FETCH_SONG:function(t,e){var n=(0,d.fetchSong)(e);return n.then(function(e){t.commit("loadSong",{song:e.data.songs[0]})}),n},FETCH_LYRIC:function(t,e){var n=(0,d.fetchLyric)(e);return n.then(function(e){t.commit("loadLyric",{lyric:e.data.lrc.lyric})}),n}},mutations:{hideWelcome:function(t){t.showWelcome=!1},addSearchWord:function(t,e){t.searchWordArr.indexOf(e.value)<0&&t.searchWordArr.unshift(e.value),t.searchWordArr.length>5&&(t.searchWordArr=t.searchWordArr.slice(0,5)),localStorage.searchWords=(0,s.default)(t.searchWordArr)},loadSongList:function(t,e){t.songs=e.songs},loadSong:function(t,e){t.song=e.song},loadLyric:function(t,e){var n=e.lyric.split("\n");t.lyricArr=r(n),t.lrcTimeArr=h.default.map(t.lyricArr,"time")},changePlaying:function(t,e){t.playing=e},changeLrcMarginTop:function(t,e){t.lrcMarginTop=e}}});e.default=p},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},,,,,,,,,,,function(t,e,n){var o,r;n(60),o=n(18);var a=n(83);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,t.exports=o},function(t,e,n){var o,r;n(63),o=n(19);var a=n(86);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-7a6ba5b0",t.exports=o},function(t,e,n){var o,r;n(58),o=n(20);var a=n(81);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-1e242355",t.exports=o},function(t,e,n){var o,r;n(61),o=n(21);var a=n(84);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-721a6158",t.exports=o},function(t,e,n){var o,r;n(59),o=n(22);var a=n(82);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-24bb8f3f",t.exports=o},function(t,e,n){var o,r;n(62),o=n(23);var a=n(85);r=o=o||{},"object"!=typeof o.default&&"function"!=typeof o.default||(r=o=o.default),"function"==typeof r&&(r=r.options),r.render=a.render,r.staticRenderFns=a.staticRenderFns,r._scopeId="data-v-7661f9c4",t.exports=o},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide-fade"}},[n("div",{staticClass:"lyric",attrs:{id:"lyric"}},[n("ul",{style:{marginTop:t.lrcMarginTop+"em"}},t._l(t.lrcArr,function(e){return n("li",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"x.show"}],key:e.time,class:e.selected?t.selectedColor:t.defaultColor},[t._v(t._s(e.lrc))])}))])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide-fade"}},[n("div",{staticClass:"song f1 container-flex box-ver"},[t.song?n("div",{staticClass:"card f1"},[n("div",{staticClass:"song-pic",class:{rotating:t.playing},style:{backgroundImage:"url("+t.song.album.picUrl+")"}}),t._v(" "),n("div",{staticClass:"song-info"},[n("h4",[t._v(t._s(t.song.name))]),t._v(" "),n("div",{staticStyle:{"font-size":"0.9em"}},[t._v(t._s(t.song.artists[0].name))])]),t._v(" "),n("div",{staticClass:"btn-controls container-flex"},[n("div",{staticClass:"btn-con",on:{click:t.handlePlay}},[n("i",{staticClass:"fa fa-2x",class:t.played,staticStyle:{color:"#090909"}})])]),t._v(" "),n("Lyric",{attrs:{id:t.id}}),t._v(" "),n("controls",{staticClass:"my-controls"})],1):t._e()])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-flex box-ver",attrs:{id:"app"}},[n("welcome",{on:{afterLeave:t.toSongs}}),t._v(" "),n("form",{attrs:{id:"form-app"},on:{submit:function(e){e.preventDefault(),t.handleSearch()}}},[n("div",{staticClass:"container-flex"},[n("div",{staticClass:"f1"},[n("mt-field",{attrs:{placeholder:"输入歌曲名或歌手名"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),n("div",{directives:[{name:"tap",rawName:"v-tap",value:{methods:t.handleSearch},expression:"{methods:handleSearch}"}],staticStyle:{"margin-left":"20px","margin-top":"4px"}},[n("mt-button",{attrs:{type:"primary"}},[t._v("搜索")])],1)]),t._v(" "),n("div",{staticClass:"my-badges"},[n("transition-group",{attrs:{name:"list"}},t._l(t.searchWordArr,function(e){return n("mt-badge",{key:e,attrs:{type:"primary",size:"normal"}},[n("span",{on:{click:function(n){t.handleWord(e)}}},[t._v(t._s(e))])])}))],1)]),t._v(" "),n("router-view",{staticClass:"view"})],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide-up"},on:{"after-leave":t.afterLeave}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"welcome neonText"},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("h2",[t._v("“好听的音乐在此处”")])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"songs animation-style-1"},t._l(t.songs,function(e){return t.show?n("mt-cell",{key:e.id,staticClass:"item",attrs:{title:e.name,label:e.artists[0].name,"is-link":"",to:"/song/"+e.id}},[n("span",{staticClass:"descp"},[t._v("Album "+t._s(e.album.name))])]):t._e()}))},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"controls"},[n("div",{staticClass:"audioplayer"},[n("audio",{staticStyle:{width:"0px",height:"0px",visibility:"hidden"},attrs:{id:"media",src:t.song.mp3Url},on:{timeupdate:t.handleTimeUpdate}},[n("source",{attrs:{src:t.song.mp3Url}})]),t._v(" "),n("div",{staticClass:"audioplayer-playpause",attrs:{title:"Play"}},[n("a",{attrs:{href:"#"}},[t._v("Play")])]),t._v(" "),n("div",{staticClass:"audioplayer-time audioplayer-time-current"},[t._v(t._s(t.currentTimeStr))]),t._v(" "),n("div",{staticClass:"audioplayer-bar",attrs:{id:"bar"}},[n("div",{staticClass:"audioplayer-bar-loaded",style:{width:t.loadedPercent+"%"},on:{click:function(e){t.changePos(e)}}}),t._v(" "),n("div",{staticClass:"audioplayer-bar-played",style:{width:t.playedPercent+"%"},on:{click:function(e){t.changePos(e)}}})]),t._v(" "),n("div",{staticClass:"audioplayer-time audioplayer-time-duration"},[t._v(t._s(t.durationStr))]),t._v(" "),n("div",{staticClass:"audioplayer-volume"},[n("div",{staticClass:"audioplayer-volume-button",attrs:{title:"Volume"}},[n("a",{attrs:{onclick:"return false;"}},[t._v("Volume")])]),t._v(" "),n("div",{staticClass:"audioplayer-volume-adjust"},[n("div",{attrs:{id:"volumeOuterBar"},on:{click:function(e){t.changeVolume(e,1)}}},[n("div",{style:{height:t.volume+"px"},attrs:{id:"volumeBar"}})])])])])])])},staticRenderFns:[]}},,,,function(t,e){}]);
//# sourceMappingURL=app.ffd6721e233a44f51993.js.map